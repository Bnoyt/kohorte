{% load static %}

  <!--   Core JS Files   -->
    <script src="{% static 'js/jquery-3.2.1.js' %}" type="text/javascript"></script>
	<script src="{% static 'js/bootstrap.min.js' %}" type="text/javascript"></script>

	<!--  Checkbox, Radio & Switch Plugins -->
	<script src="{% static 'js/bootstrap-checkbox-radio.js' %}"></script>

    <!--  Notifications Plugin    -->
    <script src="{% static 'js/bootstrap-notify.js' %}"></script>

    <!-- Paper Dashboard Core javascript and methods for Demo purpose -->
	<script src="{% static 'js/paper-dashboard.js' %}"></script>



	<script type="text/javascript">




    {% if etat_connexion %}

    notification();

    {% endif %}



        	


	</script>


    <script>





function notification(){
        $.notify({
            message: "Combinaison mot de passe / pseudo erronnée"

        },{
            type: 'danger',
            timer: 4000,
            placement: {
                from: 'top',
                align: 'center'
            }
        });
    };

function show_posts(id){
    var a = $('#c_' + id);
    var h = $('#h_' + id);
    var s = $('#s_' + id);
    if (a.is(":visible")){
        a.hide(100);
        h.hide();
        s.show();

    } else {
        a.show(100);
        s.hide();
        h.show();

    }



};


function commenter(id,type){
    var a = $('#c_' + id);
    var r = $('#r_' + id);
    if(r.is(":visible")){
        r.hide();
        show_posts(id);
        row = a.children();
        row.prepend(' <div class="col-md-11">   <div class=     </div>   ')
    }



}

function deplacer_modal(){
    $('body').prepend($('.modal'));
}

function notifier(message,type){
    $.notify({
            message: message

        },{
            type: type,
            timer: 4000,
            placement: {
                from: 'top',
                align: 'center'
            }
        });
}



$(document).ready(function(){
        
    deplacer_modal();


    function ajout_post(post){
        fildepost = $('#fildepost');
        fildepost.append(post);


    }

    function retour_ajout_post(reponse){
        $('#id_titre').val('');
        $('#id_contenu').val('');
        var message;
        var type;
        var text = reponse['texte'];
        var post = reponse['post'];

        $('body,html').scrollTop(354354354);

        if (text=="succes"){
            ajout_post(post);
            message = "Post ajouté avec succès";
            type = 'success';
            


        } else {
            type = "danger";
            if (text=='pasdecontenu'){
                message = 'Il manque le corps de votre post !';
            }
            else if (text=='titre'){
                message = 'Il manque le titre de votre post !';
            }
            else {
                message = 'Soyez serieux, faites un vrai post, tout de même !';
            }

        
        }
        notifier(message,type);

       
        

    }

    $("#form_button").click(function(event){

        event.preventDefault();

        titre = $('#id_titre').val();

        contenu = $('#id_contenu').val();

        crsftoken = $("[name='csrfmiddlewaretoken']").val();

        var id_noeud = 0;
        var id_question = 0;

        {% if noeud %}

        id_noeud = {{noeud.id}};

        {% endif %}

        {% if question %}

        id_question = {{question.id}};

        {% endif %}

        $.post('{% url "ajouter_post" %}',{csrfmiddlewaretoken:crsftoken,noeud:1,titre:titre,contenu:contenu,id_noeud:id_noeud,id_question:id_question},retour_ajout_post,'json');




    })




});






    </script>



</html>